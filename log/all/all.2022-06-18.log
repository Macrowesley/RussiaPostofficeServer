2022-06-18 10:17:42 ERROR http-nio-0.0.0.0-88-exec-2 cc.mrbird.febs.common.handler.GlobalExceptionHandler AuthorizationException, This subject is anonymous - it does not have any identifying principals and authorization operations require an identity to check against.  A Subject instance will acquire these identifying principals automatically after a successful login is performed be executing org.apache.shiro.subject.Subject.login(AuthenticationToken) or when 'Remember Me' functionality is enabled by the SecurityManager.  This exception can also occur when a previously logged-in Subject has logged out which makes it anonymous again.  Because an identity is currently not known due to any of these conditions, authorization is denied.
2022-06-18 10:17:42 WARN  http-nio-0.0.0.0-88-exec-2 org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver Resolved [org.apache.shiro.authz.UnauthenticatedException: This subject is anonymous - it does not have any identifying principals and authorization operations require an identity to check against.  A Subject instance will acquire these identifying principals automatically after a successful login is performed be executing org.apache.shiro.subject.Subject.login(AuthenticationToken) or when 'Remember Me' functionality is enabled by the SecurityManager.  This exception can also occur when a previously logged-in Subject has logged out which makes it anonymous again.  Because an identity is currently not known due to any of these conditions, authorization is denied.]
2022-06-18 10:17:43 INFO  http-nio-0.0.0.0-88-exec-9 cc.mrbird.febs.common.websocket.WebSocketServer 用户退出:8,当前在线人数为:0
2022-06-18 10:17:52 INFO  http-nio-0.0.0.0-88-exec-8 p6spy 2022-06-18 10:17:52 | 耗时 27 ms | SQL 语句：
SELECT u.user_id userId, u.username, u.realname, u.parent_id, u.email, u.mobile, u.password, u.status, u.create_time createTime, u.ssex sex, u.dept_id deptId, u.last_login_time lastLoginTime, u.modify_time modifyTime, u.description, u.avatar, u.theme, u.is_tab isTab, d.dept_name deptName, GROUP_CONCAT(r.role_id) roleId, GROUP_CONCAT(r.ROLE_NAME) roleName FROM t_user u LEFT JOIN t_dept d ON (u.dept_id = d.dept_id) LEFT JOIN t_user_role ur ON (u.user_id = ur.user_id) LEFT JOIN t_role r ON r.role_id = ur.role_id WHERE 1=1 AND u.username = 'admin' GROUP BY u.username, u.realname, u.parent_id, u.user_id, u.email, u.mobile, u.password, u.status, u.create_time, u.ssex, u.dept_id, u.last_login_time, u.modify_time, u.description, u.avatar, u.theme, u.is_tab Limit 1;
2022-06-18 10:17:52 INFO  http-nio-0.0.0.0-88-exec-8 p6spy 2022-06-18 10:17:52 | 耗时 0 ms | SQL 语句：
SELECT USER_ID,DEPT_ID FROM t_user_data_permission WHERE (USER_ID = '8');
2022-06-18 10:17:52 INFO  http-nio-0.0.0.0-88-exec-8 p6spy 2022-06-18 10:17:52 | 耗时 111 ms | SQL 语句：
INSERT INTO t_login_log ( USERNAME, LOGIN_TIME, LOCATION, IP, `SYSTEM`, BROWSER ) VALUES ( 'admin', '2022-06-18T10:17:52.633+0800', '内网IP|0|0|内网IP|内网IP', '127.0.0.1', 'Windows 10', 'Chrome 96' );
2022-06-18 10:17:52 INFO  http-nio-0.0.0.0-88-exec-5 cc.mrbird.febs.common.license.LicenseVerifyUtils 开始校验
2022-06-18 10:17:52 INFO  http-nio-0.0.0.0-88-exec-5 cc.mrbird.febs.common.license.CustomLicenseManager serverInfos不为null = LicenseCheckModel{ipAddress=[192.168.2.119], macAddress=[38-D5-47-AB-24-C0], cpuSerial='BFEBFBFF000306C3', mainBoardSerial='160881918021870'}
2022-06-18 10:17:52 INFO  http-nio-0.0.0.0-88-exec-5 cc.mrbird.febs.common.license.LicenseVerifyUtils 证书校验通过，证书有效期：2022-01-27 00:00:00 - 2026-04-01 00:00:00
2022-06-18 10:17:52 INFO  http-nio-0.0.0.0-88-exec-5 p6spy 2022-06-18 10:17:52 | 耗时 8 ms | SQL 语句：
SELECT r.* FROM t_role r LEFT JOIN t_user_role ur ON (r.role_id = ur.role_id) LEFT JOIN t_user u ON (u.user_id = ur.user_id) WHERE u.username = 'admin';
2022-06-18 10:17:52 INFO  http-nio-0.0.0.0-88-exec-5 p6spy 2022-06-18 10:17:52 | 耗时 1 ms | SQL 语句：
SELECT m.perms FROM t_role r LEFT JOIN t_user_role ur ON (r.role_id = ur.role_id) LEFT JOIN t_user u ON (u.user_id = ur.user_id) LEFT JOIN t_role_menu rm ON (rm.role_id = r.role_id) LEFT JOIN t_menu m ON (m.menu_id = rm.menu_id) WHERE u.username = 'admin' AND m.perms is not null AND m.perms <> '';
2022-06-18 10:17:52 INFO  http-nio-0.0.0.0-88-exec-5 p6spy 2022-06-18 10:17:52 | 耗时 27 ms | SQL 语句：
SELECT u.user_id userId, u.username, u.realname, u.parent_id, u.email, u.mobile, u.password, u.status, u.create_time createTime, u.ssex sex, u.dept_id deptId, u.last_login_time lastLoginTime, u.modify_time modifyTime, u.description, u.avatar, u.theme, u.is_tab isTab, d.dept_name deptName, GROUP_CONCAT(r.role_id) roleId, GROUP_CONCAT(r.ROLE_NAME) roleName FROM t_user u LEFT JOIN t_dept d ON (u.dept_id = d.dept_id) LEFT JOIN t_user_role ur ON (u.user_id = ur.user_id) LEFT JOIN t_role r ON r.role_id = ur.role_id WHERE 1=1 AND u.username = 'admin' GROUP BY u.username, u.realname, u.parent_id, u.user_id, u.email, u.mobile, u.password, u.status, u.create_time, u.ssex, u.dept_id, u.last_login_time, u.modify_time, u.description, u.avatar, u.theme, u.is_tab Limit 1;
2022-06-18 10:17:52 INFO  http-nio-0.0.0.0-88-exec-5 p6spy 2022-06-18 10:17:52 | 耗时 0 ms | SQL 语句：
SELECT COUNT( 1 ) FROM t_notice WHERE (user_id = 8 AND is_read = '0');
2022-06-18 10:17:54 INFO  http-nio-0.0.0.0-88-exec-2 cc.mrbird.febs.common.websocket.WebSocketServer 生产环境的websocket配置 cc.mrbird.febs.common.websocket.WebSocketServer@51e33df0
2022-06-18 10:17:54 INFO  http-nio-0.0.0.0-88-exec-2 cc.mrbird.febs.common.websocket.WebSocketServer 连接用户的id:8,当前在线人数为:1
2022-06-18 10:17:54 INFO  http-nio-0.0.0.0-88-exec-2 cc.mrbird.febs.common.websocket.WebSocketServer 发送消息到:8，报文:连接成功
2022-06-18 10:17:54 INFO  http-nio-0.0.0.0-88-exec-2 cc.mrbird.febs.common.websocket.WebSocketServer websocket session = org.apache.tomcat.websocket.WsSession@2e2e1f51
2022-06-18 10:17:55 INFO  http-nio-0.0.0.0-88-exec-7 p6spy 2022-06-18 10:17:55 | 耗时 1 ms | SQL 语句：
SELECT m.* FROM t_menu m WHERE m.type <> 1 AND m.MENU_ID IN ( SELECT DISTINCT rm.menu_id FROM t_role_menu rm LEFT JOIN t_role r ON (rm.role_id = r.role_id) LEFT JOIN t_user_role ur ON (ur.role_id = r.role_id) LEFT JOIN t_user u ON (u.user_id = ur.user_id) WHERE u.username = 'admin' ) ORDER BY m.order_num;
2022-06-18 10:17:55 INFO  http-nio-0.0.0.0-88-exec-6 p6spy 2022-06-18 10:17:55 | 耗时 0 ms | SQL 语句：
select count(1) from t_login_log;
2022-06-18 10:17:55 INFO  http-nio-0.0.0.0-88-exec-6 p6spy 2022-06-18 10:17:55 | 耗时 0 ms | SQL 语句：
SELECT count(1) FROM t_login_log WHERE login_time between CURDATE() and DATE_ADD(CURDATE(), INTERVAL 1 DAY);
2022-06-18 10:17:55 INFO  http-nio-0.0.0.0-88-exec-6 p6spy 2022-06-18 10:17:55 | 耗时 0 ms | SQL 语句：
SELECT count(DISTINCT(ip)) FROM t_login_log WHERE login_time between CURDATE() and DATE_ADD(CURDATE(), INTERVAL 1 DAY);
2022-06-18 10:17:55 INFO  http-nio-0.0.0.0-88-exec-6 p6spy 2022-06-18 10:17:55 | 耗时 0 ms | SQL 语句：
select date_format(l.login_time, '%m-%d') days, count(1) count from ( select * from t_login_log where date_sub(curdate(), interval 10 day) <= date(login_time) ) as l where 1 = 1 group by days;
2022-06-18 10:17:55 INFO  http-nio-0.0.0.0-88-exec-6 p6spy 2022-06-18 10:17:55 | 耗时 2 ms | SQL 语句：
select date_format(l.login_time, '%m-%d') days, count(1) count from ( select * from t_login_log where date_sub(curdate(), interval 10 day) <= date(login_time) ) as l where 1 = 1 and l.username = 'admin' group by days;
2022-06-18 10:17:55 INFO  Febs-Async-Thread-1 p6spy 2022-06-18 10:17:55 | 耗时 77 ms | SQL 语句：
UPDATE t_user SET LAST_LOGIN_TIME='2022-06-18T10:17:55.681+0800' WHERE (USERNAME = 'admin');
2022-06-18 10:17:56 INFO  http-nio-0.0.0.0-88-exec-10 p6spy 2022-06-18 10:17:56 | 耗时 0 ms | SQL 语句：
SELECT r.* FROM t_role r LEFT JOIN t_user_role ur ON (r.role_id = ur.role_id) LEFT JOIN t_user u ON (u.user_id = ur.user_id) WHERE u.username = 'admin';
2022-06-18 10:17:56 INFO  http-nio-0.0.0.0-88-exec-10 p6spy 2022-06-18 10:17:56 | 耗时 1 ms | SQL 语句：
SELECT m.perms FROM t_role r LEFT JOIN t_user_role ur ON (r.role_id = ur.role_id) LEFT JOIN t_user u ON (u.user_id = ur.user_id) LEFT JOIN t_role_menu rm ON (rm.role_id = r.role_id) LEFT JOIN t_menu m ON (m.menu_id = rm.menu_id) WHERE u.username = 'admin' AND m.perms is not null AND m.perms <> '';
2022-06-18 10:17:57 INFO  http-nio-0.0.0.0-88-exec-7 p6spy 2022-06-18 10:17:57 | 耗时 23 ms | SQL 语句：
SELECT COUNT(1) FROM rcs_print_job WHERE (type = 2);
2022-06-18 10:17:57 INFO  http-nio-0.0.0.0-88-exec-7 p6spy 2022-06-18 10:17:57 | 耗时 0 ms | SQL 语句：
SELECT id,contract_code,foreseen_id,transaction_id,user_id,pc_user_id,frank_machine_id,flow,flow_detail,total_count,total_amount,type,cancel_msg_code,updated_time,created_time FROM rcs_print_job WHERE (type = 2) ORDER BY id DESC LIMIT 0,10;
2022-06-18 10:19:57 INFO  http-nio-0.0.0.0-88-exec-3 cc.mrbird.febs.rcs.controller.ViewController 得到的transactionId=0ac5a047-33e1-4c8c-b762-93b0ef9292f5
2022-06-18 10:19:57 INFO  http-nio-0.0.0.0-88-exec-3 p6spy 2022-06-18 10:19:57 | 耗时 55 ms | SQL 语句：
SELECT id,foreseen_id,post_office,frank_machine_id,contract_code,start_date_time,stop_date_time,user_id,credit_val,amount,count,graph_id,tax_version,transaction_status,updated_time,created_time FROM rcs_transaction WHERE (id = '0ac5a047-33e1-4c8c-b762-93b0ef9292f5');
2022-06-18 10:19:57 INFO  http-nio-0.0.0.0-88-exec-3 cc.mrbird.febs.rcs.controller.ViewController 详情 foreseen = Transaction(id=0ac5a047-33e1-4c8c-b762-93b0ef9292f5, foreseenId=0262c8e6-ed67-4068-b27c-bb4eb4f26e1a, postOffice=131000, frankMachineId=PM100200, contractCode=00000177, startDateTime=2022-03-22T15:02:47.000+08:00, stopDateTime=2022-03-22T15:03:18.000+08:00, userId=MXX001_0001, creditVal=0.0, amount=50.0, count=1, graphId=, taxVersion=11.0.7, transactionStatus=1, updatedTime=Tue Mar 22 15:03:18 CST 2022, createdTime=Tue Mar 22 15:02:48 CST 2022)
2022-06-18 10:20:00 INFO  http-nio-0.0.0.0-88-exec-10 cc.mrbird.febs.rcs.controller.ViewController 得到的transactionId=0000cffcc-c277-4145-8b42-694114f54601
2022-06-18 10:20:00 INFO  http-nio-0.0.0.0-88-exec-10 p6spy 2022-06-18 10:20:00 | 耗时 5 ms | SQL 语句：
SELECT id,foreseen_id,post_office,frank_machine_id,contract_code,start_date_time,stop_date_time,user_id,credit_val,amount,count,graph_id,tax_version,transaction_status,updated_time,created_time FROM rcs_transaction WHERE (id = '0000cffcc-c277-4145-8b42-694114f54601');
2022-06-18 10:20:00 ERROR http-nio-0.0.0.0-88-exec-10 cc.mrbird.febs.common.handler.GlobalExceptionHandler 系统内部异常，异常信息 null
2022-06-18 10:20:00 WARN  http-nio-0.0.0.0-88-exec-10 org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver Resolved [java.lang.NullPointerException]
2022-06-18 10:20:06 INFO  http-nio-0.0.0.0-88-exec-1 cc.mrbird.febs.rcs.controller.ViewController 得到的transactionId=2d0bd3cc-d514-45fb-9e73-295676f3c4b3
2022-06-18 10:20:06 INFO  http-nio-0.0.0.0-88-exec-1 p6spy 2022-06-18 10:20:06 | 耗时 0 ms | SQL 语句：
SELECT id,foreseen_id,post_office,frank_machine_id,contract_code,start_date_time,stop_date_time,user_id,credit_val,amount,count,graph_id,tax_version,transaction_status,updated_time,created_time FROM rcs_transaction WHERE (id = '2d0bd3cc-d514-45fb-9e73-295676f3c4b3');
2022-06-18 10:20:06 INFO  http-nio-0.0.0.0-88-exec-1 cc.mrbird.febs.rcs.controller.ViewController 详情 foreseen = Transaction(id=2d0bd3cc-d514-45fb-9e73-295676f3c4b3, foreseenId=ce55fdfe-64f8-41ec-83d2-254d622c28b4, postOffice=131000, frankMachineId=PM100200, contractCode=00000177, startDateTime=2022-03-22T15:49:04.000+08:00, stopDateTime=2022-03-22T15:51:59.000+08:00, userId=MXX001_0001, creditVal=0.0, amount=50.0, count=1, graphId=, taxVersion=11.0.7, transactionStatus=1, updatedTime=Tue Mar 22 15:51:59 CST 2022, createdTime=Tue Mar 22 15:49:05 CST 2022)
2022-06-18 10:23:55 INFO  http-nio-0.0.0.0-88-exec-5 p6spy 2022-06-18 10:23:55 | 耗时 10 ms | SQL 语句：
SELECT COUNT(1) FROM rcs_print_job WHERE (type = 2);
2022-06-18 10:23:55 INFO  http-nio-0.0.0.0-88-exec-5 p6spy 2022-06-18 10:23:55 | 耗时 0 ms | SQL 语句：
SELECT id,contract_code,foreseen_id,transaction_id,user_id,pc_user_id,frank_machine_id,flow,flow_detail,total_count,total_amount,type,cancel_msg_code,updated_time,created_time FROM rcs_print_job WHERE (type = 2) ORDER BY id DESC LIMIT 0,10;
